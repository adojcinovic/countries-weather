<div class="card">
  @if (weather$ | async; as weather) {
    @if (hovered) {
      <!-- Hover overlay -->
      <div class="overlay" (mouseenter)="onHover()" (mouseleave)="hovered = false">
        <img
          class="overlay-flag"
          [src]="country.flags.svg"
          [alt]="country.name.common + ' flag'"
        />
        <h3>{{ country.name.common }}</h3>
        <p class="overlay-capital">{{ country.capital[0] }}</p>

        <dl class="overlay-details">
          <div>
            <dt>Temperature</dt>
            <dd>{{ weather.temperature }}°C</dd>
          </div>
          <div>
            <dt>Condition</dt>
            <dd>{{ weather.emoji }} {{ weather.condition }}</dd>
          </div>
          <div>
            <dt>Wind speed</dt>
            <dd>{{ weather.windSpeed }} km/h</dd>
          </div>
          <div>
            <dt>Humidity</dt>
            <dd>{{ weather.humidity }}%</dd>
          </div>
          <div>
            <dt>Feels like</dt>
            <dd>{{ weather.feelsLike }}°C</dd>
          </div>
        </dl>
      </div>
    } @else {
      <!-- Default card with weather loaded -->
      <div class="card-default" (mouseenter)="onHover()" (mouseleave)="hovered = false">
        <img
          class="card-flag"
          [src]="country.flags.png"
          [alt]="country.name.common + ' flag'"
        />

        <div class="card-body">
          <h3 class="card-name">{{ country.name.common }}</h3>
          <p class="card-capital">{{ country.capital[0] }}</p>
          <p class="card-pop">Pop: {{ country.population | population }}</p>
          <p class="card-weather">
            {{ weather.emoji }} {{ weather.temperature }}°C
          </p>
        </div>
      </div>
    }
  } @else if (hovered && weather$) {
    <!-- Loading state -->
    <div class="card-loading" (mouseleave)="hovered = false">
      <div class="spinner"></div>
      <p>Loading weather...</p>
    </div>
  } @else {
    <!-- Default card, no weather yet -->
    <div class="card-default" (mouseenter)="onHover()" (mouseleave)="hovered = false">
      <img
        class="card-flag"
        [src]="country.flags.png"
        [alt]="country.name.common + ' flag'"
      />

      <div class="card-body">
        <h3 class="card-name">{{ country.name.common }}</h3>
        <p class="card-capital">{{ country.capital[0] }}</p>
        <p class="card-pop">Pop: {{ country.population | population }}</p>
      </div>
    </div>
  }
</div>
